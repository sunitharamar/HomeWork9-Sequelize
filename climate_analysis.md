
# Step 3 - Climate Analysis and Exploration
You are now ready to use Python and SQLAlchemy to do basic climate analysis and data exploration on your new weather station tables. All of the following analysis should be completed using SQLAlchemy ORM queries, Pandas, and Matplotlib.

Create a Jupyter Notebook file called climate_analysis.ipynb and use it to complete your climate analysis and data exporation.

Choose a start date and end date for your trip. Make sure that your vacation range is approximately 3-15 days total.

Use SQLAlchemy create_engine to connect to your sqlite database.

Use SQLAlchemy automap_base() to reflect your tables into classes and save a reference to those classes called Station and Measurement.

Precipitation Analysis Design a query to retrieve the last 12 months of precipitation data.

Select only the date and prcp values.

Load the query results into a Pandas DataFrame and set the index to the date column.

Plot the results using the DataFrame plot method.


```python
# All dependency
import pandas as pd
import numpy as np
import json
import matplotlib.pyplot as plt
import requests as req
import seaborn as sns
from datetime import datetime, date, timedelta
from  matplotlib.ticker import FuncFormatter
import matplotlib.patches as mpatches

from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, Integer, String, Date
from sqlalchemy.orm import Session
from sqlalchemy.ext.automap import automap_base
from sqlalchemy import extract
from sqlalchemy import func, desc
import pymysql
pymysql.install_as_MySQLdb()
 
```


```python
#Use SQLAlchemy create_engine to connect to your already created/saved data,  sqlite database.
#engine = create_engine("sqlite:///hawaii.sqlite")
engine = create_engine("sqlite:///dropna_hawaii.sqlite")
```


```python
# Declare a Base using `automap_base()`\n",
Base = automap_base()
```


```python
# Use the Base class to reflect the database tables\n",
Base.prepare(engine, reflect=True)
 
```


```python
# Print all of the classes mapped to the Base\n",
Base.classes.keys()
```




    ['measurements', 'stations']




```python
# Assign the Measurement class to a variable called measurement
measurement = Base.classes.measurements
```


```python
Base.classes.measurements
```




    sqlalchemy.ext.automap.measurements




```python
# Assign the Measurement class to a variable called station
station = Base.classes.stations
```


```python
# Assign the station class to a variable called station
Base.classes.stations
```




    sqlalchemy.ext.automap.stations




```python
# Create a session
from sqlalchemy.orm import Session
session = Session(bind=engine)
```

## Precipitation Analysis Design a query to retrieve the last 12 months of precipitation data.


```python
# Assigned the Measurement class to a variable called measurement in previous sections.

# Here saving my query to a list
mylist = session.query(measurement.date, measurement.prcp).filter(measurement.date.between('2016-08-23', '2017-08-23')).all() 
 
```


```python
mylist
len(mylist)
```




    2021




```python
engine = engine.connect()
engine
```




    <sqlalchemy.engine.base.Connection at 0x1a1eddfb00>




```python
# Converting my list to a dataframe.
df = pd.DataFrame.from_records(mylist)
df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-08-23</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-08-24</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-08-25</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-08-26</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-08-27</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Renaming the columns to Date and Precipitation
prcp_analysis_df = df.rename(columns={0: "Date", 1: "precipitation"})
prcp_analysis_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-08-23</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-08-24</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-08-25</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-08-26</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-08-27</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>




```python
#  set the index to the date column.
prcp_analysis_df.set_index(['Date'], inplace=True)
prcp_analysis_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>precipitation</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-08-23</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2016-08-24</th>
      <td>0.08</td>
    </tr>
    <tr>
      <th>2016-08-25</th>
      <td>0.08</td>
    </tr>
    <tr>
      <th>2016-08-26</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2016-08-27</th>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>




```python
type(prcp_analysis_df.precipitation[0])
```




    numpy.float64




```python
plt.style.use('ggplot')
fig = plt.figure() 
 
```


```python
#Plot the results using the DataFrame plot method.

prcp_analysis_df.plot(figsize = (18,8), color='blue', rot = 340 )
plt.show()
 
```


    <matplotlib.figure.Figure at 0x1a1d63fef0>



![png](climate_analysis_files/climate_analysis_20_1.png)


# Station Analysis
Design a query to calculate the total number of stations.

Design a query to find the most active stations.

List the stations and observation counts in descending order
Which station has the highest number of observations?
Design a query to retrieve the last 12 months of temperature observation data (tobs).

Filter by the station with the highest number of observations.
Plot the results as a histogram with bins=12.


```python
tot_stations = session.query(station.station).filter(station.station == 'USC00519397').count()
tot_stations
 
```




    1



## Design a query to calculate the total number of stations.


```python
 

tol_num_stations = session.query(measurement).group_by(measurement.station).count()
tol_num_stations
 
```




    9




```python
# Design a query to find the most active stations.
from sqlalchemy import create_engine, func, inspect
inspector = inspect(engine)
inspector.get_table_names()

```




    ['measurements', 'stations']



## Design a query to find the most active stations. 


```python
Active_stations = session.query(measurement.station, station.name, measurement.date, func.count(measurement.tobs)).\
                          join(station, station.station == measurement.station).\
                          group_by(measurement.station).\
                          order_by(func.count(measurement.tobs).desc()).all()

            
#List the stations and observation counts in descending order Which station has the highest number of observations?
Active_stations

```




    [('USC00519281', 'WAIHEE 837.5, HI US', '2017-08-18', 2772),
     ('USC00513117', 'KANEOHE 838.1, HI US', '2017-07-31', 2696),
     ('USC00519397', 'WAIKIKI 717.2, HI US', '2017-08-23', 2685),
     ('USC00519523', 'WAIMANALO EXPERIMENTAL FARM, HI US', '2017-08-23', 2572),
     ('USC00516128', 'MANOA LYON ARBO 785.2, HI US', '2017-08-23', 2484),
     ('USC00514830', 'KUALOA RANCH HEADQUARTERS 886.9, HI US', '2017-08-23', 1937),
     ('USC00511918', 'HONOLULU OBSERVATORY 702.2, HI US', '2015-10-30', 1932),
     ('USC00517948', 'PEARL CITY, HI US', '2017-07-28', 683),
     ('USC00518838', 'UPPER WAHIAWA 874.3, HI US', '2015-10-20', 342)]




```python
type(Active_stations)
```




    list




```python
Active_stations[0][0]
```




    'USC00519281'




```python
#Filter by the station with the highest number of observations.
Active_stations[0][0:2]
```




    ('USC00519281', 'WAIHEE 837.5, HI US')




```python
#Design a query to retrieve the last 12 months of temperature observation data (tobs).
station_tobs = session.query(measurement.station, station.station.name, measurement.date, measurement.tobs).\
               filter(measurement.station == (Active_stations[0][0])).\
               filter(measurement.date.between('2016-08-23', '2017-08-23')).all()
            
        
len(station_tobs)

```




    352




```python
type(station_tobs)
```




    list




```python
# Converting my station_temp_tobs to a dataframe.
tobs_df = pd.DataFrame.from_records(station_tobs)
tobs_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-23</td>
      <td>77</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-24</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-25</td>
      <td>80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-26</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-27</td>
      <td>75</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Renaming the columns to station, name, tobs
station_analysis_df = tobs_df.rename(columns={0: "station", 1: "name", 2: "date", 3: "tobs"})
station_analysis_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>station</th>
      <th>name</th>
      <th>date</th>
      <th>tobs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-23</td>
      <td>77</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-24</td>
      <td>77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-25</td>
      <td>80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-26</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USC00519281</td>
      <td>USC00519281</td>
      <td>2016-08-27</td>
      <td>75</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Plot the results as a histogram with bins=12.
plt.style.use('ggplot')
fig = plt.figure() 
plt.figsize = (18,8)

x = station_analysis_df['tobs'] 

# the histogram of the data
plt.hist(x, bins=12)


#create legend
red_patch = mpatches.Patch(color='red', label='tobs')
plt.legend(handles=[red_patch])

plt.xlabel('Temperature')
plt.ylabel('Frequency')
plt.title('Temperature Frequency of the Station')
plt.grid(True)
plt.show()

 
plt.show()

```


![png](climate_analysis_files/climate_analysis_35_0.png)


# Temperature Analysis
Write a function called calc_temps that will accept a start date and end date in the format %Y-%m-%d and return the minimum, average, and maximum temperatures for that range of dates.

Use the calc_temps function to calculate the min, avg, and max temperatures for your trip using the matching dates from the previous year (i.e. use "2017-01-01" if your trip start date was "2018-01-01")

Plot the min, avg, and max temperature from your previous query as a bar chart.

Use the average temperature as the bar height.
Use the peak-to-peak (tmax-tmin) value as the y error bar (yerr).


```python
#rather than calling for your temps every time with sqlalchemy, is to call them all once and store them in a DataFrame 

#Write a function called calc_temps that will accept a start date and end date 
#in the format %Y-%m-%d and return the minimum, average, and maximum temperatures for that range of dates.

#from datetime import datetime

#temp_list = []

#def calc_temps(start, end):
#    date_format = "%Y-%m-%d"
 
#    temp_max = session.query(func.max(measurement.tobs)).\
#                           filter(measurement.date.between(start, end)).one()
            
#    temp_min = session.query(func.min(measurement.tobs)).\
#                           filter(measurement.date.between(start, end)).one()
            
#    temp_avg = session.query(func.avg(measurement.tobs)).\
#                           filter(measurement.date.between(start, end)).one()
    
#    temps = (temp_max, temp_min, temp_avg)
#    for i in temps:
#        temp_list.append(i)
     
#    return(temp_max, temp_min, temp_avg)




# temp_max, temp_min, temp_mean = calc_temps("2017-01-01", "2018-01-01")    
 
```


```python
# running a sqlalchemy query to get the date and tobs from  the measurement table.
tobs_date = session.query(measurement.date, measurement.tobs).all()
tobs_date                   
```




    [('2010-01-01', 65),
     ('2010-01-02', 63),
     ('2010-01-03', 74),
     ('2010-01-04', 76),
     ('2010-01-07', 70),
     ('2010-01-08', 64),
     ('2010-01-09', 68),
     ('2010-01-10', 73),
     ('2010-01-11', 64),
     ('2010-01-12', 61),
     ('2010-01-14', 66),
     ('2010-01-15', 65),
     ('2010-01-16', 68),
     ('2010-01-17', 64),
     ('2010-01-18', 72),
     ('2010-01-19', 66),
     ('2010-01-20', 66),
     ('2010-01-21', 69),
     ('2010-01-22', 67),
     ('2010-01-23', 67),
     ('2010-01-24', 71),
     ('2010-01-25', 67),
     ('2010-01-26', 76),
     ('2010-01-27', 68),
     ('2010-01-28', 72),
     ('2010-01-31', 67),
     ('2010-02-01', 66),
     ('2010-02-04', 69),
     ('2010-02-05', 67),
     ('2010-02-06', 67),
     ('2010-02-07', 64),
     ('2010-02-08', 69),
     ('2010-02-09', 73),
     ('2010-02-11', 73),
     ('2010-02-12', 69),
     ('2010-02-13', 69),
     ('2010-02-14', 69),
     ('2010-02-15', 71),
     ('2010-02-16', 61),
     ('2010-02-17', 69),
     ('2010-02-20', 64),
     ('2010-02-21', 65),
     ('2010-02-22', 67),
     ('2010-02-23', 68),
     ('2010-02-24', 65),
     ('2010-02-25', 76),
     ('2010-02-26', 75),
     ('2010-02-28', 66),
     ('2010-03-01', 70),
     ('2010-03-02', 72),
     ('2010-03-03', 73),
     ('2010-03-04', 70),
     ('2010-03-05', 71),
     ('2010-03-06', 72),
     ('2010-03-07', 72),
     ('2010-03-08', 69),
     ('2010-03-09', 70),
     ('2010-03-12', 72),
     ('2010-03-13', 73),
     ('2010-03-14', 70),
     ('2010-03-15', 71),
     ('2010-03-17', 68),
     ('2010-03-18', 70),
     ('2010-03-21', 72),
     ('2010-03-22', 69),
     ('2010-03-23', 68),
     ('2010-03-24', 74),
     ('2010-03-27', 72),
     ('2010-03-28', 73),
     ('2010-03-29', 74),
     ('2010-03-30', 73),
     ('2010-03-31', 73),
     ('2010-04-01', 74),
     ('2010-04-02', 74),
     ('2010-04-03', 74),
     ('2010-04-04', 71),
     ('2010-04-05', 72),
     ('2010-04-06', 75),
     ('2010-04-08', 75),
     ('2010-04-09', 75),
     ('2010-04-10', 75),
     ('2010-04-11', 73),
     ('2010-04-12', 73),
     ('2010-04-13', 71),
     ('2010-04-15', 71),
     ('2010-04-16', 68),
     ('2010-04-17', 70),
     ('2010-04-18', 71),
     ('2010-04-19', 74),
     ('2010-04-20', 71),
     ('2010-04-21', 75),
     ('2010-04-22', 76),
     ('2010-04-23', 75),
     ('2010-04-24', 75),
     ('2010-04-25', 76),
     ('2010-04-26', 76),
     ('2010-04-28', 76),
     ('2010-04-30', 77),
     ('2010-05-01', 77),
     ('2010-05-02', 73),
     ('2010-05-03', 74),
     ('2010-05-04', 76),
     ('2010-05-05', 76),
     ('2010-05-06', 80),
     ('2010-05-07', 74),
     ('2010-05-08', 77),
     ('2010-05-09', 77),
     ('2010-05-10', 76),
     ('2010-05-11', 77),
     ('2010-05-13', 78),
     ('2010-05-14', 78),
     ('2010-05-15', 75),
     ('2010-05-16', 73),
     ('2010-05-17', 77),
     ('2010-05-18', 76),
     ('2010-05-19', 77),
     ('2010-05-22', 78),
     ('2010-05-23', 75),
     ('2010-05-24', 77),
     ('2010-05-25', 77),
     ('2010-05-26', 77),
     ('2010-05-27', 76),
     ('2010-05-28', 75),
     ('2010-05-29', 77),
     ('2010-05-30', 77),
     ('2010-05-31', 77),
     ('2010-06-01', 78),
     ('2010-06-02', 76),
     ('2010-06-03', 78),
     ('2010-06-04', 76),
     ('2010-06-05', 77),
     ('2010-06-06', 78),
     ('2010-06-07', 77),
     ('2010-06-08', 78),
     ('2010-06-09', 78),
     ('2010-06-10', 79),
     ('2010-06-11', 78),
     ('2010-06-12', 78),
     ('2010-06-13', 78),
     ('2010-06-14', 77),
     ('2010-06-15', 78),
     ('2010-06-16', 78),
     ('2010-06-17', 77),
     ('2010-06-18', 77),
     ('2010-06-19', 82),
     ('2010-06-20', 78),
     ('2010-06-21', 78),
     ('2010-06-22', 78),
     ('2010-06-23', 78),
     ('2010-06-24', 78),
     ('2010-06-25', 77),
     ('2010-06-26', 76),
     ('2010-06-27', 78),
     ('2010-06-28', 78),
     ('2010-06-29', 78),
     ('2010-06-30', 78),
     ('2010-07-01', 75),
     ('2010-07-02', 77),
     ('2010-07-03', 77),
     ('2010-07-04', 78),
     ('2010-07-05', 78),
     ('2010-07-06', 76),
     ('2010-07-07', 74),
     ('2010-07-08', 76),
     ('2010-07-09', 74),
     ('2010-07-10', 76),
     ('2010-07-11', 78),
     ('2010-07-12', 77),
     ('2010-07-13', 80),
     ('2010-07-17', 76),
     ('2010-07-18', 77),
     ('2010-07-19', 77),
     ('2010-07-21', 80),
     ('2010-07-22', 78),
     ('2010-07-24', 80),
     ('2010-07-25', 79),
     ('2010-07-26', 78),
     ('2010-07-27', 79),
     ('2010-07-28', 78),
     ('2010-07-29', 79),
     ('2010-07-30', 78),
     ('2010-07-31', 77),
     ('2010-08-01', 77),
     ('2010-08-02', 76),
     ('2010-08-03', 77),
     ('2010-08-04', 77),
     ('2010-08-05', 75),
     ('2010-08-06', 75),
     ('2010-08-07', 80),
     ('2010-08-08', 77),
     ('2010-08-09', 78),
     ('2010-08-10', 78),
     ('2010-08-11', 77),
     ('2010-08-12', 76),
     ('2010-08-13', 78),
     ('2010-08-14', 78),
     ('2010-08-15', 76),
     ('2010-08-16', 76),
     ('2010-08-17', 74),
     ('2010-08-18', 77),
     ('2010-08-19', 79),
     ('2010-08-20', 79),
     ('2010-08-21', 79),
     ('2010-08-22', 75),
     ('2010-08-23', 87),
     ('2010-08-24', 78),
     ('2010-08-25', 76),
     ('2010-08-26', 78),
     ('2010-08-27', 78),
     ('2010-08-28', 79),
     ('2010-08-29', 78),
     ('2010-08-30', 78),
     ('2010-08-31', 80),
     ('2010-09-01', 77),
     ('2010-09-02', 76),
     ('2010-09-03', 78),
     ('2010-09-04', 77),
     ('2010-09-05', 77),
     ('2010-09-06', 77),
     ('2010-09-07', 76),
     ('2010-09-08', 78),
     ('2010-09-09', 78),
     ('2010-09-10', 78),
     ('2010-09-11', 78),
     ('2010-09-12', 74),
     ('2010-09-13', 78),
     ('2010-09-14', 79),
     ('2010-09-15', 77),
     ('2010-09-16', 79),
     ('2010-09-17', 78),
     ('2010-09-19', 78),
     ('2010-09-20', 78),
     ('2010-09-21', 79),
     ('2010-09-22', 76),
     ('2010-09-23', 78),
     ('2010-09-24', 78),
     ('2010-09-25', 79),
     ('2010-09-26', 74),
     ('2010-09-27', 75),
     ('2010-09-28', 75),
     ('2010-09-29', 78),
     ('2010-09-30', 73),
     ('2010-10-01', 78),
     ('2010-10-02', 78),
     ('2010-10-03', 78),
     ('2010-10-04', 78),
     ('2010-10-05', 80),
     ('2010-10-06', 79),
     ('2010-10-07', 79),
     ('2010-10-08', 78),
     ('2010-10-09', 78),
     ('2010-10-10', 78),
     ('2010-10-11', 77),
     ('2010-10-12', 79),
     ('2010-10-13', 78),
     ('2010-10-15', 78),
     ('2010-10-16', 77),
     ('2010-10-17', 76),
     ('2010-10-18', 76),
     ('2010-10-19', 72),
     ('2010-10-20', 74),
     ('2010-10-21', 80),
     ('2010-10-22', 77),
     ('2010-10-23', 75),
     ('2010-10-24', 78),
     ('2010-10-25', 78),
     ('2010-10-26', 76),
     ('2010-10-27', 79),
     ('2010-10-28', 78),
     ('2010-10-29', 78),
     ('2010-10-30', 77),
     ('2010-10-31', 76),
     ('2010-11-01', 75),
     ('2010-11-02', 73),
     ('2010-11-05', 77),
     ('2010-11-06', 76),
     ('2010-11-07', 77),
     ('2010-11-08', 76),
     ('2010-11-09', 73),
     ('2010-11-10', 73),
     ('2010-11-11', 77),
     ('2010-11-12', 77),
     ('2010-11-13', 76),
     ('2010-11-16', 73),
     ('2010-11-17', 73),
     ('2010-11-20', 69),
     ('2010-11-21', 69),
     ('2010-11-22', 68),
     ('2010-11-23', 69),
     ('2010-11-24', 76),
     ('2010-11-25', 76),
     ('2010-11-27', 75),
     ('2010-11-28', 74),
     ('2010-11-29', 69),
     ('2010-11-30', 74),
     ('2010-12-01', 76),
     ('2010-12-03', 74),
     ('2010-12-04', 74),
     ('2010-12-06', 64),
     ('2010-12-07', 64),
     ('2010-12-08', 67),
     ('2010-12-09', 77),
     ('2010-12-10', 66),
     ('2010-12-11', 69),
     ('2010-12-12', 68),
     ('2010-12-13', 68),
     ('2010-12-14', 71),
     ('2010-12-15', 74),
     ('2010-12-16', 67),
     ('2010-12-17', 66),
     ('2010-12-18', 69),
     ('2010-12-19', 71),
     ('2010-12-23', 70),
     ('2010-12-24', 70),
     ('2010-12-27', 74),
     ('2010-12-28', 71),
     ('2010-12-29', 75),
     ('2010-12-30', 75),
     ('2010-12-31', 72),
     ('2011-01-01', 69),
     ('2011-01-02', 72),
     ('2011-01-03', 74),
     ('2011-01-04', 73),
     ('2011-01-05', 64),
     ('2011-01-06', 65),
     ('2011-01-07', 68),
     ('2011-01-08', 62),
     ('2011-01-09', 58),
     ('2011-01-10', 73),
     ('2011-01-11', 60),
     ('2011-01-14', 76),
     ('2011-01-15', 68),
     ('2011-01-16', 66),
     ('2011-01-17', 64),
     ('2011-01-18', 64),
     ('2011-01-19', 64),
     ('2011-01-20', 76),
     ('2011-01-21', 75),
     ('2011-01-22', 68),
     ('2011-01-23', 68),
     ('2011-01-24', 72),
     ('2011-01-25', 63),
     ('2011-01-27', 68),
     ('2011-01-28', 75),
     ('2011-01-29', 65),
     ('2011-01-30', 64),
     ('2011-01-31', 68),
     ('2011-02-01', 68),
     ('2011-02-02', 66),
     ('2011-02-03', 67),
     ('2011-02-04', 64),
     ('2011-02-05', 65),
     ('2011-02-06', 75),
     ('2011-02-07', 68),
     ('2011-02-08', 71),
     ('2011-02-09', 71),
     ('2011-02-10', 71),
     ('2011-02-13', 68),
     ('2011-02-14', 72),
     ('2011-02-15', 70),
     ('2011-02-16', 74),
     ('2011-02-19', 67),
     ('2011-02-20', 71),
     ('2011-02-21', 71),
     ('2011-02-22', 71),
     ('2011-02-23', 74),
     ('2011-02-24', 68),
     ('2011-02-25', 71),
     ('2011-02-26', 69),
     ('2011-02-27', 69),
     ('2011-02-28', 68),
     ('2011-03-01', 68),
     ('2011-03-02', 72),
     ('2011-03-03', 74),
     ('2011-03-04', 72),
     ('2011-03-05', 69),
     ('2011-03-06', 70),
     ('2011-03-09', 71),
     ('2011-03-10', 71),
     ('2011-03-12', 72),
     ('2011-03-13', 70),
     ('2011-03-14', 71),
     ('2011-03-16', 76),
     ('2011-03-17', 73),
     ('2011-03-18', 74),
     ('2011-03-19', 74),
     ('2011-03-20', 74),
     ('2011-03-21', 74),
     ('2011-03-22', 74),
     ('2011-03-23', 74),
     ('2011-03-24', 73),
     ('2011-03-25', 74),
     ('2011-03-26', 74),
     ('2011-03-27', 73),
     ('2011-03-28', 74),
     ('2011-03-30', 75),
     ('2011-03-31', 74),
     ('2011-04-01', 74),
     ('2011-04-02', 75),
     ('2011-04-03', 74),
     ('2011-04-04', 75),
     ('2011-04-05', 74),
     ('2011-04-06', 70),
     ('2011-04-07', 70),
     ('2011-04-08', 70),
     ('2011-04-09', 76),
     ('2011-04-10', 76),
     ('2011-04-11', 76),
     ('2011-04-12', 76),
     ('2011-04-13', 70),
     ('2011-04-15', 77),
     ('2011-04-16', 74),
     ('2011-04-17', 73),
     ('2011-04-18', 76),
     ('2011-04-19', 76),
     ('2011-04-20', 74),
     ('2011-04-21', 77),
     ('2011-04-22', 77),
     ('2011-04-23', 78),
     ('2011-04-24', 77),
     ('2011-04-25', 77),
     ('2011-04-26', 76),
     ('2011-04-27', 77),
     ('2011-04-29', 78),
     ('2011-04-30', 76),
     ('2011-05-01', 77),
     ('2011-05-02', 77),
     ('2011-05-03', 70),
     ('2011-05-04', 76),
     ('2011-05-05', 74),
     ('2011-05-06', 72),
     ('2011-05-07', 74),
     ('2011-05-08', 73),
     ('2011-05-09', 75),
     ('2011-05-10', 75),
     ('2011-05-11', 75),
     ('2011-05-12', 76),
     ('2011-05-13', 77),
     ('2011-05-14', 78),
     ('2011-05-15', 77),
     ('2011-05-16', 78),
     ('2011-05-17', 77),
     ('2011-05-18', 76),
     ('2011-05-19', 77),
     ('2011-05-20', 79),
     ('2011-05-21', 77),
     ('2011-05-22', 74),
     ('2011-05-23', 78),
     ('2011-05-24', 77),
     ('2011-05-25', 79),
     ('2011-05-26', 78),
     ('2011-05-27', 78),
     ('2011-05-28', 77),
     ('2011-05-29', 78),
     ('2011-05-30', 78),
     ('2011-05-31', 73),
     ('2011-06-01', 77),
     ('2011-06-02', 78),
     ('2011-06-03', 73),
     ('2011-06-04', 70),
     ('2011-06-05', 76),
     ('2011-06-06', 77),
     ('2011-06-07', 77),
     ('2011-06-08', 77),
     ('2011-06-09', 77),
     ('2011-06-10', 78),
     ('2011-06-11', 77),
     ('2011-06-12', 77),
     ('2011-06-13', 78),
     ('2011-06-14', 78),
     ('2011-06-15', 77),
     ('2011-06-17', 78),
     ('2011-06-18', 78),
     ('2011-06-19', 75),
     ('2011-06-20', 76),
     ('2011-06-21', 76),
     ('2011-06-25', 78),
     ('2011-06-26', 76),
     ('2011-06-27', 77),
     ('2011-06-28', 75),
     ('2011-06-29', 77),
     ('2011-07-01', 77),
     ('2011-07-02', 78),
     ('2011-07-03', 78),
     ('2011-07-04', 78),
     ('2011-07-05', 78),
     ('2011-07-06', 76),
     ('2011-07-07', 76),
     ('2011-07-08', 77),
     ('2011-07-09', 77),
     ('2011-07-10', 77),
     ('2011-07-11', 78),
     ('2011-07-12', 77),
     ('2011-07-13', 73),
     ('2011-07-14', 77),
     ('2011-07-15', 79),
     ('2011-07-16', 78),
     ('2011-07-17', 77),
     ('2011-07-18', 78),
     ('2011-07-19', 78),
     ('2011-07-20', 76),
     ('2011-07-21', 77),
     ('2011-07-23', 78),
     ('2011-07-24', 77),
     ('2011-07-25', 78),
     ('2011-07-26', 78),
     ('2011-07-27', 77),
     ('2011-07-28', 77),
     ('2011-07-29', 78),
     ('2011-07-30', 80),
     ('2011-07-31', 77),
     ('2011-08-01', 78),
     ('2011-08-02', 77),
     ('2011-08-03', 78),
     ('2011-08-04', 76),
     ('2011-08-05', 78),
     ('2011-08-06', 77),
     ('2011-08-07', 78),
     ('2011-08-08', 78),
     ('2011-08-09', 79),
     ('2011-08-11', 78),
     ('2011-08-12', 78),
     ('2011-08-13', 76),
     ('2011-08-14', 78),
     ('2011-08-15', 77),
     ('2011-08-16', 79),
     ('2011-08-17', 77),
     ('2011-08-18', 77),
     ('2011-08-19', 78),
     ('2011-08-20', 77),
     ('2011-08-21', 77),
     ('2011-08-22', 78),
     ('2011-08-23', 78),
     ('2011-08-24', 79),
     ('2011-08-25', 78),
     ('2011-08-26', 78),
     ('2011-08-27', 79),
     ('2011-08-28', 76),
     ('2011-08-29', 76),
     ('2011-08-30', 78),
     ('2011-08-31', 79),
     ('2011-09-02', 79),
     ('2011-09-03', 78),
     ('2011-09-04', 77),
     ('2011-09-05', 77),
     ('2011-09-06', 73),
     ('2011-09-07', 73),
     ('2011-09-08', 77),
     ('2011-09-09', 79),
     ('2011-09-10', 77),
     ('2011-09-11', 77),
     ('2011-09-12', 85),
     ('2011-09-13', 77),
     ('2011-09-14', 76),
     ('2011-09-15', 79),
     ('2011-09-16', 79),
     ('2011-09-17', 77),
     ('2011-09-18', 77),
     ('2011-09-19', 82),
     ('2011-09-20', 80),
     ('2011-09-21', 79),
     ('2011-09-22', 78),
     ('2011-09-23', 76),
     ('2011-09-24', 77),
     ('2011-09-25', 74),
     ('2011-09-26', 77),
     ('2011-09-27', 78),
     ('2011-09-28', 77),
     ('2011-10-01', 78),
     ('2011-10-02', 78),
     ('2011-10-03', 80),
     ('2011-10-06', 75),
     ('2011-10-07', 78),
     ('2011-10-08', 79),
     ('2011-10-09', 78),
     ('2011-10-10', 77),
     ('2011-10-11', 78),
     ('2011-10-12', 77),
     ('2011-10-13', 77),
     ('2011-10-14', 78),
     ('2011-10-15', 77),
     ('2011-10-16', 76),
     ('2011-10-17', 77),
     ('2011-10-18', 76),
     ('2011-10-19', 74),
     ('2011-10-20', 78),
     ('2011-10-21', 76),
     ('2011-10-22', 77),
     ('2011-10-23', 75),
     ('2011-10-24', 74),
     ('2011-10-25', 77),
     ('2011-10-26', 76),
     ('2011-10-27', 77),
     ('2011-10-28', 73),
     ('2011-10-29', 76),
     ('2011-10-30', 75),
     ('2011-10-31', 76),
     ('2011-11-01', 71),
     ('2011-11-02', 77),
     ('2011-11-03', 77),
     ('2011-11-04', 75),
     ('2011-11-05', 76),
     ('2011-11-06', 77),
     ('2011-11-07', 78),
     ('2011-11-08', 76),
     ('2011-11-09', 76),
     ('2011-11-10', 76),
     ('2011-11-11', 74),
     ('2011-11-12', 75),
     ('2011-11-13', 76),
     ('2011-11-14', 73),
     ('2011-11-15', 71),
     ('2011-11-16', 75),
     ('2011-11-17', 76),
     ('2011-11-18', 78),
     ('2011-11-19', 76),
     ('2011-11-20', 75),
     ('2011-11-21', 76),
     ('2011-11-22', 73),
     ('2011-11-23', 75),
     ('2011-11-24', 73),
     ('2011-11-25', 70),
     ('2011-11-26', 75),
     ('2011-11-27', 73),
     ('2011-11-28', 72),
     ('2011-11-29', 72),
     ('2011-11-30', 66),
     ('2011-12-01', 69),
     ('2011-12-02', 68),
     ('2011-12-03', 73),
     ('2011-12-04', 74),
     ('2011-12-05', 73),
     ('2011-12-06', 73),
     ('2011-12-07', 73),
     ('2011-12-08', 73),
     ('2011-12-09', 71),
     ('2011-12-10', 73),
     ('2011-12-11', 73),
     ('2011-12-12', 77),
     ('2011-12-13', 72),
     ('2011-12-14', 71),
     ('2011-12-15', 73),
     ('2011-12-16', 70),
     ('2011-12-17', 73),
     ('2011-12-18', 69),
     ('2011-12-19', 74),
     ('2011-12-20', 72),
     ('2011-12-21', 71),
     ('2011-12-22', 72),
     ('2011-12-23', 72),
     ('2011-12-24', 70),
     ('2011-12-25', 73),
     ('2011-12-26', 73),
     ('2011-12-27', 72),
     ('2011-12-28', 73),
     ('2011-12-29', 73),
     ('2011-12-30', 72),
     ('2011-12-31', 63),
     ('2012-01-01', 63),
     ('2012-01-02', 66),
     ('2012-01-03', 66),
     ('2012-01-04', 74),
     ('2012-01-06', 71),
     ('2012-01-07', 65),
     ('2012-01-08', 61),
     ('2012-01-10', 71),
     ('2012-01-11', 65),
     ('2012-01-12', 66),
     ('2012-01-14', 61),
     ('2012-01-15', 74),
     ('2012-01-16', 75),
     ('2012-01-17', 75),
     ('2012-01-18', 75),
     ('2012-01-19', 68),
     ('2012-01-20', 73),
     ('2012-01-21', 74),
     ('2012-01-22', 74),
     ('2012-01-23', 67),
     ('2012-01-24', 66),
     ('2012-01-25', 69),
     ('2012-01-26', 74),
     ('2012-01-27', 68),
     ('2012-01-28', 72),
     ('2012-01-29', 72),
     ('2012-01-30', 71),
     ('2012-01-31', 71),
     ('2012-02-01', 66),
     ('2012-02-02', 72),
     ('2012-02-03', 63),
     ('2012-02-04', 65),
     ('2012-02-05', 69),
     ('2012-02-06', 71),
     ('2012-02-07', 71),
     ('2012-02-08', 65),
     ('2012-02-09', 61),
     ('2012-02-10', 71),
     ('2012-02-11', 72),
     ('2012-02-12', 72),
     ('2012-02-13', 72),
     ('2012-02-14', 65),
     ('2012-02-15', 66),
     ('2012-02-16', 73),
     ('2012-02-17', 73),
     ('2012-02-18', 71),
     ('2012-02-19', 72),
     ('2012-02-20', 73),
     ('2012-02-21', 72),
     ('2012-02-22', 73),
     ('2012-02-23', 77),
     ('2012-02-24', 67),
     ('2012-02-25', 69),
     ('2012-02-26', 73),
     ('2012-02-27', 72),
     ('2012-02-28', 73),
     ('2012-02-29', 74),
     ('2012-03-01', 73),
     ('2012-03-02', 67),
     ('2012-03-03', 71),
     ('2012-03-04', 72),
     ('2012-03-05', 67),
     ('2012-03-06', 69),
     ('2012-03-07', 67),
     ('2012-03-08', 69),
     ('2012-03-09', 66),
     ('2012-03-10', 73),
     ('2012-03-11', 74),
     ('2012-03-12', 71),
     ('2012-03-13', 72),
     ('2012-03-14', 73),
     ('2012-03-15', 71),
     ('2012-03-16', 72),
     ('2012-03-17', 73),
     ('2012-03-18', 72),
     ('2012-03-19', 73),
     ('2012-03-20', 69),
     ('2012-03-21', 73),
     ('2012-03-22', 74),
     ('2012-03-23', 72),
     ('2012-03-24', 74),
     ('2012-03-25', 74),
     ('2012-03-26', 72),
     ('2012-03-27', 70),
     ('2012-03-28', 71),
     ('2012-03-29', 72),
     ('2012-03-30', 73),
     ('2012-03-31', 74),
     ('2012-04-01', 73),
     ('2012-04-02', 74),
     ('2012-04-03', 75),
     ('2012-04-04', 74),
     ('2012-04-05', 74),
     ('2012-04-06', 74),
     ('2012-04-07', 74),
     ('2012-04-08', 74),
     ('2012-04-09', 72),
     ('2012-04-10', 69),
     ('2012-04-11', 71),
     ('2012-04-12', 70),
     ('2012-04-13', 71),
     ('2012-04-14', 70),
     ('2012-04-15', 75),
     ('2012-04-16', 75),
     ('2012-04-17', 75),
     ('2012-04-18', 75),
     ('2012-04-19', 75),
     ('2012-04-20', 75),
     ('2012-04-21', 74),
     ('2012-04-22', 69),
     ('2012-04-23', 73),
     ('2012-04-24', 73),
     ('2012-04-25', 75),
     ('2012-04-26', 74),
     ('2012-04-27', 75),
     ('2012-04-28', 76),
     ('2012-04-29', 75),
     ('2012-04-30', 75),
     ('2012-05-01', 75),
     ('2012-05-02', 75),
     ('2012-05-03', 75),
     ('2012-05-04', 75),
     ('2012-05-05', 74),
     ('2012-05-06', 75),
     ('2012-05-07', 74),
     ('2012-05-08', 75),
     ('2012-05-09', 74),
     ('2012-05-10', 74),
     ('2012-05-11', 75),
     ('2012-05-12', 75),
     ('2012-05-13', 72),
     ('2012-05-14', 74),
     ('2012-05-15', 74),
     ('2012-05-16', 75),
     ('2012-05-17', 76),
     ('2012-05-18', 77),
     ('2012-05-19', 77),
     ('2012-05-20', 77),
     ('2012-05-21', 76),
     ('2012-05-22', 77),
     ('2012-05-23', 76),
     ('2012-05-24', 78),
     ('2012-05-25', 77),
     ('2012-05-26', 76),
     ('2012-05-27', 76),
     ('2012-05-28', 77),
     ('2012-05-29', 76),
     ('2012-05-30', 76),
     ('2012-05-31', 73),
     ('2012-06-01', 76),
     ('2012-06-02', 76),
     ('2012-06-03', 75),
     ('2012-06-04', 77),
     ('2012-06-05', 77),
     ('2012-06-06', 76),
     ('2012-06-07', 78),
     ('2012-06-10', 77),
     ('2012-06-11', 76),
     ('2012-06-12', 76),
     ('2012-06-13', 77),
     ('2012-06-14', 77),
     ('2012-06-15', 78),
     ('2012-06-16', 77),
     ('2012-06-17', 77),
     ('2012-06-18', 77),
     ('2012-06-19', 76),
     ('2012-06-20', 75),
     ('2012-06-21', 76),
     ('2012-06-22', 76),
     ('2012-06-23', 77),
     ('2012-06-24', 76),
     ('2012-06-25', 73),
     ('2012-06-26', 73),
     ('2012-06-27', 75),
     ('2012-06-28', 77),
     ('2012-06-29', 76),
     ('2012-06-30', 77),
     ('2012-07-01', 76),
     ('2012-07-02', 77),
     ('2012-07-03', 74),
     ('2012-07-04', 77),
     ('2012-07-05', 77),
     ('2012-07-06', 78),
     ('2012-07-07', 76),
     ('2012-07-08', 77),
     ('2012-07-10', 76),
     ('2012-07-11', 76),
     ('2012-07-12', 76),
     ('2012-07-13', 77),
     ('2012-07-14', 78),
     ('2012-07-15', 77),
     ('2012-07-16', 78),
     ('2012-07-17', 78),
     ('2012-07-18', 78),
     ('2012-07-19', 75),
     ('2012-07-20', 77),
     ('2012-07-21', 76),
     ('2012-07-22', 76),
     ('2012-07-23', 79),
     ('2012-07-24', 77),
     ('2012-07-25', 77),
     ('2012-07-26', 77),
     ('2012-07-27', 77),
     ('2012-07-28', 77),
     ('2012-07-29', 73),
     ('2012-07-30', 78),
     ('2012-07-31', 78),
     ('2012-08-01', 79),
     ('2012-08-02', 78),
     ('2012-08-03', 78),
     ('2012-08-04', 78),
     ('2012-08-05', 78),
     ('2012-08-06', 77),
     ('2012-08-07', 77),
     ('2012-08-08', 78),
     ('2012-08-09', 78),
     ('2012-08-10', 76),
     ('2012-08-11', 75),
     ('2012-08-12', 78),
     ('2012-08-13', 78),
     ('2012-08-14', 77),
     ('2012-08-15', 79),
     ('2012-08-16', 78),
     ('2012-08-17', 78),
     ('2012-08-20', 79),
     ('2012-08-21', 77),
     ('2012-08-22', 77),
     ('2012-08-23', 78),
     ('2012-08-24', 78),
     ('2012-08-25', 78),
     ('2012-08-26', 78),
     ('2012-08-27', 73),
     ('2012-08-28', 75),
     ('2012-08-29', 78),
     ('2012-08-30', 78),
     ('2012-08-31', 78),
     ('2012-09-01', 77),
     ('2012-09-02', 76),
     ('2012-09-03', 77),
     ('2012-09-04', 77),
     ('2012-09-05', 75),
     ('2012-09-06', 77),
     ('2012-09-07', 75),
     ('2012-09-08', 78),
     ('2012-09-09', 76),
     ('2012-09-10', 77),
     ('2012-09-11', 77),
     ('2012-09-12', 76),
     ('2012-09-13', 76),
     ('2012-09-14', 78),
     ('2012-09-15', 78),
     ('2012-09-16', 77),
     ('2012-09-17', 78),
     ('2012-09-18', 71),
     ('2012-09-19', 74),
     ('2012-09-20', 76),
     ('2012-09-21', 77),
     ('2012-09-22', 77),
     ('2012-09-23', 76),
     ('2012-09-24', 77),
     ('2012-09-25', 76),
     ('2012-09-26', 76),
     ('2012-09-27', 78),
     ('2012-09-28', 78),
     ('2012-09-29', 77),
     ('2012-09-30', 75),
     ('2012-10-01', 78),
     ('2012-10-02', 74),
     ('2012-10-03', 75),
     ('2012-10-04', 77),
     ('2012-10-05', 73),
     ('2012-10-06', 73),
     ('2012-10-07', 76),
     ('2012-10-08', 78),
     ('2012-10-09', 75),
     ('2012-10-10', 75),
     ('2012-10-11', 80),
     ('2012-10-12', 78),
     ('2012-10-13', 79),
     ('2012-10-14', 78),
     ('2012-10-15', 78),
     ('2012-10-16', 77),
     ('2012-10-17', 72),
     ('2012-10-18', 75),
     ('2012-10-19', 77),
     ('2012-10-20', 78),
     ('2012-10-21', 77),
     ('2012-10-22', 76),
     ('2012-10-23', 78),
     ('2012-10-24', 78),
     ('2012-10-25', 76),
     ('2012-10-26', 76),
     ('2012-10-27', 74),
     ('2012-10-28', 77),
     ('2012-10-29', 77),
     ('2012-10-30', 76),
     ('2012-10-31', 78),
     ('2012-11-01', 71),
     ('2012-11-02', 70),
     ('2012-11-03', 74),
     ('2012-11-04', 71),
     ('2012-11-05', 69),
     ('2012-11-06', 76),
     ('2012-11-07', 77),
     ('2012-11-08', 77),
     ('2012-11-09', 76),
     ('2012-11-10', 75),
     ('2012-11-11', 76),
     ('2012-11-12', 77),
     ('2012-11-13', 77),
     ('2012-11-14', 77),
     ('2012-11-15', 75),
     ('2012-11-16', 73),
     ('2012-11-17', 74),
     ('2012-11-18', 76),
     ('2012-11-19', 75),
     ('2012-11-20', 75),
     ('2012-11-21', 71),
     ('2012-11-22', 69),
     ('2012-11-23', 71),
     ('2012-11-24', 69),
     ('2012-11-25', 74),
     ('2012-11-26', 72),
     ('2012-11-27', 74),
     ('2012-11-28', 65),
     ('2012-11-29', 67),
     ('2012-11-30', 65),
     ('2012-12-01', 65),
     ('2012-12-02', 71),
     ('2012-12-03', 76),
     ('2012-12-04', 70),
     ('2012-12-05', 76),
     ('2012-12-08', 69),
     ('2012-12-09', 74),
     ('2012-12-10', 76),
     ('2012-12-11', 74),
     ('2012-12-12', 73),
     ('2012-12-13', 73),
     ('2012-12-14', 74),
     ('2012-12-15', 73),
     ('2012-12-16', 73),
     ('2012-12-17', 73),
     ...]




```python
# Converting my tobs_date list to a dataframe.
tobs_date_df = pd.DataFrame.from_records(tobs_date)
tobs_date_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-01-01</td>
      <td>65</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-01-02</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010-01-03</td>
      <td>74</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010-01-04</td>
      <td>76</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010-01-07</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Renaming the columns to date, tobs
tobs_date_df = tobs_date_df.rename(columns={0: "date", 1: "tobs" })
tobs_date_df.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>tobs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-01-01</td>
      <td>65</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-01-02</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010-01-03</td>
      <td>74</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010-01-04</td>
      <td>76</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010-01-07</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Here I am making a function which asks for 2 dates and returns a plot of the temperatures
# Also saving my data in a dataframe and calling the sqlalchemy only once to get all the data.

#Somehow the dataframe calculation does not show exactly the "yerr" on this graph. I tried very hard. But could not.
 

def calc_temps(date1, date2):
    mask = (tobs_date_df['date'] >= date1) & (tobs_date_df['date'] <= date2)
    
    fig, ax = plt.subplots(figsize = (5,8))
    ax.bar(x= [1], width = 1, height = tobs_date_df[mask]['tobs'].mean(), yerr = (tobs_date_df[mask]['tobs'].max()-tobs_date_df[mask]['tobs'].min()))       
    
    ax.set_xticks([0,1,2])
    ax.tick_params(axis='x',which='both', labelbottom='off')
    
    ax.set_yticks([0,20,40,60,80,100])
    plt.title('Trip Average Temp', fontsize = 14)
    ax.set_ylabel('Temp (F)', fontsize = 12)
    plt.show()
    
    
    print('The trip average temperature is: %s degrees' % tobs_date_df[mask]['tobs'].mean())
    print('The trip max temperature is: %s degrees' % tobs_date_df[mask]['tobs'].max())
    print('The trip minimum temperature is: %s degrees' % tobs_date_df[mask]['tobs'].min())
 
```


```python
calc_temps("2017-03-10", "2017-03-20") 
```


![png](climate_analysis_files/climate_analysis_42_0.png)


    The trip average temperature is: 71.64406779661017 degrees
    The trip max temperature is: 82 degrees
    The trip minimum temperature is: 65 degrees


# Optional Recommended Analysis
The following are optional challenge queries. These are highly recommended to attempt, but not required for the homework.

1) Calcualte the rainfall per weather station using the previous year's matching dates.
2) Calculate the daily normals. Normals are the averages for min, avg, and max temperatures.

Create a function called daily_normals that will calculate the daily normals for a specific date. This date string will be in the format %m-%d. Be sure to use all historic tobs that match that date string.
Create a list of dates for your trip in the format %m-%d. Use the daily_normals function to calculate the normals for each date string and append the results to a list.
Load the list of daily normals into a Pandas DataFrame and set the index equal to the date.
Use Pandas to plot an area plot (stacked=False) for the daily normals.



```python
#Calcualte the rainfall per weather station using the previous year's matching dates.
number_station = session.query(measurement.station, func.sum(measurement.prcp).label('rainfall')).\
                 filter(measurement.date.between('2016-08-23', '2017-08-23')).\
                 group_by(measurement.station).\
                 order_by(desc('rainfall')).all()
    
    
number_station 
```




    [('USC00516128', 147.81000000000006),
     ('USC00519281', 70.03000000000003),
     ('USC00513117', 48.510000000000026),
     ('USC00519523', 38.01),
     ('USC00514830', 33.239999999999995),
     ('USC00519397', 16.089999999999986),
     ('USC00517948', 4.59)]




```python
type(measurement.prcp)
```




    sqlalchemy.orm.attributes.InstrumentedAttribute




```python
#Create a function called `daily_normals` that will calculate the daily normals for a specific date. 
#This date string will be in the format `%m-%d`. Be sure to use all historic tobs that match that date string.

def daily_normals(chosen_date):
    
    record = str(chosen_date).split('-')
    chosen_month = record[0]
    chosen_day = record[1]
    
    results = session.query(func.min(measurement.tobs), func.avg(measurement.tobs), func.max(measurement.tobs)).\
               filter((extract('month', measurement.date)==chosen_month) and (extract('day', measurement.date)==chosen_day)).\
               group_by(measurement.station).all()
        
    date_daily_normal_df = pd.DataFrame(results[:], columns=['Min_Temp', 'Avg_Temp', 'Max_Temp'])
         
    T_min = date_daily_normal_df["Min_Temp"].mean()
    T_avg = date_daily_normal_df["Avg_Temp"].mean()
    T_max = date_daily_normal_df["Max_Temp"].mean()
    
    
    return(T_min, T_avg, T_max)


 
```


```python
#Create a list of dates for your trip in the format `%m-%d`. Use the `daily_normals` function to calculate the 
#normals for each date string and append the results to a list.
#Load the list of daily normals into a Pandas DataFrame and set the index equal to the date.

chosen_date_tmin_list = []
chosen_date_tavg_list = []
chosen_date_tmax_list = []

chosen_date_list = ['1-2','2-17','3-23', '7-04', '10-14', '5-24', '9-10']

for chosen_date in chosen_date_list:
    
    min_temp, avg_temp, max_temp = daily_normals(chosen_date)
    
    chosen_date_tmin_list.append(min_temp)
    chosen_date_tavg_list.append(avg_temp)
    chosen_date_tmax_list.append(max_temp)
next
info_data = {"Date": chosen_date_list, "T_Min": chosen_date_tmin_list, "T_Avg": chosen_date_tavg_list, "T_Max": chosen_date_tmax_list}
info_df = pd.DataFrame(info_data)
info_df.set_index('Date', inplace=True, )
info_df
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T_Avg</th>
      <th>T_Max</th>
      <th>T_Min</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1-2</th>
      <td>68.881903</td>
      <td>78.333333</td>
      <td>57.333333</td>
    </tr>
    <tr>
      <th>2-17</th>
      <td>69.579099</td>
      <td>79.111111</td>
      <td>59.222222</td>
    </tr>
    <tr>
      <th>3-23</th>
      <td>69.946996</td>
      <td>78.888889</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>7-04</th>
      <td>75.909180</td>
      <td>82.666667</td>
      <td>69.222222</td>
    </tr>
    <tr>
      <th>10-14</th>
      <td>75.347900</td>
      <td>82.777778</td>
      <td>67.777778</td>
    </tr>
    <tr>
      <th>5-24</th>
      <td>73.753177</td>
      <td>81.111111</td>
      <td>66.222222</td>
    </tr>
    <tr>
      <th>9-10</th>
      <td>76.171867</td>
      <td>84.000000</td>
      <td>69.222222</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Use Pandas to plot an area plot (`stacked=False`) for the daily normals.
info_df.plot(kind='area', stacked=False, alpha=0.5, colormap='Spectral')
plt.show()
```


![png](climate_analysis_files/climate_analysis_48_0.png)



```python
#Create a function called `daily_normals` that will calculate the daily normals for a specific date. with sqlalchhemy session

special_date_list = ['1-2','2-17','3-23', '7-04', '10-14', '5-24', '9-10']

stmt = session.query(func.min(measurement.tobs).label("Min Temp"),
                     func.max(measurement.tobs).label("Max Temp"),
                     func.avg(measurement.tobs).label("Avg Temp")).\
                     filter(func.strftime("%m-%d", measurement.date)=='12-20').\
                     group_by(measurement.date).all()
stmt
```




    [(68, 73, 71.16666666666667),
     (70, 74, 71.57142857142857),
     (65, 71, 69.66666666666667),
     (69, 79, 72.75),
     (72, 81, 76.5),
     (72, 75, 73.6),
     (73, 77, 75.5)]




```python
special_date_list = ['1-2','2-17','3-23', '7-04', '10-14', '5-24', '9-10']

stmt = session.query(func.min(measurement.tobs).label("Min-Temp"),
                     func.max(measurement.tobs).label("Max-Temp"),
                     func.avg(measurement.tobs).label("Avg-Temp")).\
                     filter(func.strftime("%m-%d", measurement.date)=='12-20').\
                     group_by(measurement.date).subquery()
stmt
```




    <sqlalchemy.sql.selectable.Alias at 0x1a1f446c50; %(112193727568 anon)s>


